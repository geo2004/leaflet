<!DOCTYPE html>
<html>
<head>
	
	<title>Belajar Leaflet 2</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js" integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg==" crossorigin=""></script>
    
	<!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.2.3/dist/esri-leaflet.js"
    integrity="sha512-YZ6b5bXRVwipfqul5krehD9qlbJzc6KOGXYsDjU9HHXW2gK57xmWl2gU6nAegiErAqFXhygKIsWPKbjLPXVb2g=="
    crossorigin=""></script>
	
  <!-- Load Esri Leaflet Geocoder from CDN -->
  <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.css"
    integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ=="
    crossorigin="">
  <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.js"
    integrity="sha512-zdT4Pc2tIrc6uoYly2Wp8jh6EPEWaveqqD3sT0lf5yei19BC1WulGuh5CesB0ldBKZieKGD7Qyf/G0jdSe016A=="
    crossorigin=""></script>
 
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.66.0/dist/L.Control.Locate.min.css" />

<script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.66.0/dist/L.Control.Locate.min.js" charset="utf-8"></script>
	<script src="L.Control.MousePosition.css" charset="utf-8"></script>
	<script src="L.Control.MousePosition.js" charset="utf-8"></script>

<style>
    body { margin:0; padding:0; }
    #map { position: absolute; top:0; bottom:0; right:0; left:0; }
  </style>

	
</head>
<body>

<div id="map"></div>
<script>
	
	var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';
    
    var gray = L.layerGroup();
  // more than one service can be grouped together and passed to the control together
  L.esri.basemapLayer("DarkGray").addTo(gray);
  L.esri.basemapLayer("GrayLabels").addTo(gray);
  
	var grayscale   = L.tileLayer(mbUrl, {id: 'mapbox.light'}),
		streets  = L.tileLayer(mbUrl, {id: 'mapbox.streets'});
        satellites  = L.tileLayer(mbUrl, {id: 'mapbox.satellite'});
        
          var pkp = L.esri.featureLayer({
      url: "https://sigi.pu.go.id/portalpupr2/rest/services/SatuPeta/Peta_PKP/FeatureServer/0",
      style: function (feature) {
          return {color: '#55b4da', weight: 1 };
      }
  });
         
 var iplt = L.esri.dynamicMapLayer({
  url: 'https://sigi.pu.go.id/portalpupr2/rest/services/SatuPeta/Satu_Peta_IPLT/MapServer',
	   useCors: true,
    layers: [0],
  });
          
          
          var map = L.map('map', {
		center: [-7, 110],
		zoom: 10,
		layers: [streets, pkp, iplt]
	});
    	var baseLayers = {
		"Grayscale ESRI": gray,
		"Grayscale Mapbox": grayscale,
		"Streets Mapbox": streets,
    "Satellites Mapbox": satellites,
	};
    
    var overlays = {
	      "PKP": pkp,
        "IPLT": iplt,
	};
    L.control.layers(baseLayers,overlays,{}, {collapsed: true}).addTo(map);
	L.control.scale().addTo(map);
  var lc = L.control.locate({
    position: 'topleft',
    strings: {
        title: "Zoom to your location"
    }
}).addTo(map);
		
	
	
  pkp.bindPopup(function (layer) {
    return L.Util.template('<p>{kondisi}<br>{propinsi}<br>{kecamatan}</p>', layer.feature.properties);
  });
	 iplt.bindPopup(function (error, featureCollection) {
if(error || featureCollection.features.length === 0) {
  return false;
} else {
  return 'Name: ' + featureCollection.features[0].properties.namobj;}
}); 
		 var searchControl = L.esri.Geocoding.geosearch().addTo(map);
  var results = L.layerGroup().addTo(map);
  searchControl.on('results', function(data){
    results.clearLayers();
    for (var i = data.results.length - 1; i >= 0; i--) {
      results.addLayer(L.marker(data.results[i].latlng));
    }
  }); 
L.control.mousePosition().addTo(map);
  
</script>
</body>
</html>
